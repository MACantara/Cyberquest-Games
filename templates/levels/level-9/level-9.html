{% extends "base.html" %}
{% block content %}
<!-- Level 9: Operation Blackout - DDoS Defense -->
<div class="min-h-screen bg-gradient-to-br from-red-900 via-gray-900 to-black text-white">
    <!-- Alert Banner -->
    <div id="alert-banner" class="bg-red-600 text-white p-3 text-center animate-pulse">
        <div class="flex items-center justify-center gap-2">
            <i class="bi bi-exclamation-triangle text-xl"></i>
            <span class="font-bold">CRITICAL ALERT: THE NULL IS LAUNCHING MASSIVE DDOS ATTACKS ON CITY INFRASTRUCTURE</span>
            <i class="bi bi-exclamation-triangle text-xl"></i>
        </div>
    </div>

    <!-- Opening Cutscene Modal -->
    <div id="cutscene-modal" class="fixed inset-0 bg-black bg-opacity-95 flex items-center justify-center z-50">
        <div class="bg-red-900 border-2 border-red-500 rounded-lg p-8 max-w-3xl mx-4">
            <div class="text-center mb-6">
                <div class="w-20 h-20 bg-red-500 rounded-full flex items-center justify-center mx-auto mb-4 animate-pulse">
                    <i class="bi bi-shield-exclamation text-white text-3xl"></i>
                </div>
                <h2 class="text-3xl font-bold text-red-300 mb-4">‚ö†Ô∏è OPERATION BLACKOUT</h2>
                <div class="bg-black/50 border border-red-600 rounded p-4 mb-4">
                    <div class="text-red-200 text-lg font-semibold mb-2">üö® INCOMING TRANSMISSION FROM SOC COMMAND</div>
                    <div class="text-red-100 text-sm">
                        "Nova, this is Commander Vega. The Null has just launched a coordinated DDoS attack against the entire city's critical infrastructure. 
                        Hospitals, power grids, emergency services - everything is under siege simultaneously."
                    </div>
                </div>
                <div class="bg-orange-900/50 border border-orange-500 rounded p-4 mb-4">
                    <div class="text-orange-200 text-lg font-semibold mb-2">üìç CURRENT SITUATION</div>
                    <div class="text-orange-100 text-sm space-y-1">
                        <div>‚Ä¢ 500+ Gbps attack traffic detected</div>
                        <div>‚Ä¢ Multiple infrastructure nodes going offline</div>
                        <div>‚Ä¢ Emergency services reporting service disruption</div>
                        <div>‚Ä¢ Lives are at immediate risk</div>
                    </div>
                </div>
                <div class="bg-blue-900/50 border border-blue-500 rounded p-4">
                    <div class="text-blue-200 text-lg font-semibold mb-2">üéØ YOUR MISSION</div>
                    <div class="text-blue-100 text-sm">
                        Take control of the city's SOC defense grid. You must defend each critical infrastructure node 
                        by implementing real-time DDoS mitigation strategies. Time is critical - people's lives depend on keeping these systems online.
                    </div>
                </div>
            </div>
            <button id="start-defense" class="w-full bg-red-500 hover:bg-red-600 text-white font-bold py-4 px-6 rounded-lg text-lg">
                üõ°Ô∏è DEPLOY TO DEFENSE GRID
            </button>
        </div>
    </div>

    <!-- Main SOC Interface -->
    <div class="p-4">
        <!-- SOC Header with Real-time Stats -->
        <div class="bg-gray-800/90 backdrop-blur border border-red-500 rounded-lg p-4 mb-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 bg-red-500 rounded-lg flex items-center justify-center animate-pulse">
                        <i class="bi bi-shield-exclamation text-white text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold text-red-300">SOC Defense Grid - Operation Blackout</h1>
                        <p class="text-red-200">Real-time DDoS Attack Mitigation System</p>
                    </div>
                </div>
                <div class="text-right">
                    <div class="text-sm text-gray-400">Mission Timer</div>
                    <div class="text-2xl font-bold text-red-400" id="mission-timer">00:00</div>
                </div>
            </div>
            
            <!-- Real-time Attack Statistics -->
            <div class="grid grid-cols-5 gap-4 mt-4 bg-black/30 rounded p-3">
                <div class="text-center">
                    <div class="text-3xl font-bold text-red-400" id="attack-volume">0</div>
                    <div class="text-xs text-gray-400">Gbps Incoming</div>
                </div>
                <div class="text-center">
                    <div class="text-3xl font-bold text-orange-400" id="nodes-under-attack">0</div>
                    <div class="text-xs text-gray-400">Nodes Under Attack</div>
                </div>
                <div class="text-center">
                    <div class="text-3xl font-bold text-green-400" id="mitigations-deployed">0</div>
                    <div class="text-xs text-gray-400">Mitigations Active</div>
                </div>
                <div class="text-center">
                    <div class="text-3xl font-bold text-blue-400" id="uptime-maintained">100</div>
                    <div class="text-xs text-gray-400">% Uptime</div>
                </div>
                <div class="text-center">
                    <div class="text-3xl font-bold text-yellow-400" id="response-score">0</div>
                    <div class="text-xs text-gray-400">Defense Score</div>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-12 gap-4">
            <!-- City Infrastructure Map -->
            <div class="col-span-8 bg-gray-900/90 backdrop-blur border border-gray-600 rounded-lg p-4">
                <h3 class="text-lg font-semibold text-cyan-300 mb-4 flex items-center gap-2">
                    <i class="bi bi-geo-alt"></i> City Critical Infrastructure Map
                </h3>
                
                <!-- SVG-based City Map -->
                <div class="bg-black/50 rounded-lg p-4 relative min-h-96">
                    <svg id="city-map" width="100%" height="400" viewBox="0 0 800 400" class="border border-gray-700 rounded">
                        <!-- Background Grid -->
                        <defs>
                            <pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse">
                                <path d="M 40 0 L 0 0 0 40" fill="none" stroke="#374151" stroke-width="1" opacity="0.3"/>
                            </pattern>
                        </defs>
                        <rect width="100%" height="100%" fill="url(#grid)" />
                        
                        <!-- City Districts (Background) -->
                        <rect x="50" y="50" width="200" height="120" fill="#1f2937" stroke="#4b5563" stroke-width="2" rx="10" opacity="0.3"/>
                        <text x="150" y="45" text-anchor="middle" fill="#9ca3af" font-size="12">Downtown District</text>
                        
                        <rect x="300" y="80" width="180" height="100" fill="#1f2937" stroke="#4b5563" stroke-width="2" rx="10" opacity="0.3"/>
                        <text x="390" y="75" text-anchor="middle" fill="#9ca3af" font-size="12">Medical District</text>
                        
                        <rect x="520" y="60" width="200" height="130" fill="#1f2937" stroke="#4b5563" stroke-width="2" rx="10" opacity="0.3"/>
                        <text x="620" y="55" text-anchor="middle" fill="#9ca3af" font-size="12">Industrial Zone</text>
                        
                        <rect x="100" y="220" width="250" height="120" fill="#1f2937" stroke="#4b5563" stroke-width="2" rx="10" opacity="0.3"/>
                        <text x="225" y="215" text-anchor="middle" fill="#9ca3af" font-size="12">Residential Area</text>
                        
                        <rect x="400" y="240" width="300" height="100" fill="#1f2937" stroke="#4b5563" stroke-width="2" rx="10" opacity="0.3"/>
                        <text x="550" y="235" text-anchor="middle" fill="#9ca3af" font-size="12">Government Quarter</text>

                        <!-- Infrastructure Nodes -->
                        <!-- Hospital System -->
                        <g id="hospital-node" class="infrastructure-node cursor-pointer" data-node="hospital">
                            <circle cx="350" cy="120" r="25" fill="#dc2626" stroke="#fca5a5" stroke-width="3" class="node-circle animate-pulse"/>
                            <circle cx="350" cy="120" r="30" fill="none" stroke="#dc2626" stroke-width="2" opacity="0.3" class="attack-indicator">
                                <animate attributeName="r" values="30;45;30" dur="2s" repeatCount="indefinite"/>
                                <animate attributeName="opacity" values="0.3;0.1;0.3" dur="2s" repeatCount="indefinite"/>
                            </circle>
                            <text x="350" y="125" text-anchor="middle" fill="white" font-size="10" font-weight="bold">üè•</text>
                            <text x="350" y="150" text-anchor="middle" fill="#fca5a5" font-size="10">Hospital</text>
                            <rect x="320" y="155" width="60" height="8" fill="#7f1d1d" rx="4"/>
                            <rect x="320" y="155" width="20" height="8" fill="#dc2626" rx="4" class="health-bar">
                                <animate attributeName="width" values="60;20;40;15;25" dur="5s" repeatCount="indefinite"/>
                            </rect>
                        </g>

                        <!-- Power Grid -->
                        <g id="power-node" class="infrastructure-node cursor-pointer" data-node="power">
                            <circle cx="650" cy="140" r="25" fill="#ea580c" stroke="#fed7aa" stroke-width="3" class="node-circle animate-pulse"/>
                            <circle cx="650" cy="140" r="30" fill="none" stroke="#ea580c" stroke-width="2" opacity="0.3" class="attack-indicator">
                                <animate attributeName="r" values="30;45;30" dur="1.8s" repeatCount="indefinite"/>
                                <animate attributeName="opacity" values="0.3;0.1;0.3" dur="1.8s" repeatCount="indefinite"/>
                            </circle>
                            <text x="650" y="145" text-anchor="middle" fill="white" font-size="10" font-weight="bold">‚ö°</text>
                            <text x="650" y="170" text-anchor="middle" fill="#fed7aa" font-size="10">Power Grid</text>
                            <rect x="620" y="175" width="60" height="8" fill="#7c2d12" rx="4"/>
                            <rect x="620" y="175" width="45" height="8" fill="#ea580c" rx="4" class="health-bar">
                                <animate attributeName="width" values="60;30;50;25;40" dur="4s" repeatCount="indefinite"/>
                            </rect>
                        </g>

                        <!-- Emergency Services -->
                        <g id="emergency-node" class="infrastructure-node cursor-pointer" data-node="emergency">
                            <circle cx="150" cy="100" r="25" fill="#b91c1c" stroke="#fca5a5" stroke-width="3" class="node-circle animate-pulse"/>
                            <circle cx="150" cy="100" r="30" fill="none" stroke="#b91c1c" stroke-width="2" opacity="0.3" class="attack-indicator">
                                <animate attributeName="r" values="30;50;30" dur="1.5s" repeatCount="indefinite"/>
                                <animate attributeName="opacity" values="0.3;0.1;0.3" dur="1.5s" repeatCount="indefinite"/>
                            </circle>
                            <text x="150" y="105" text-anchor="middle" fill="white" font-size="10" font-weight="bold">üö®</text>
                            <text x="150" y="130" text-anchor="middle" fill="#fca5a5" font-size="10">911 Services</text>
                            <rect x="120" y="135" width="60" height="8" fill="#7f1d1d" rx="4"/>
                            <rect x="120" y="135" width="15" height="8" fill="#b91c1c" rx="4" class="health-bar">
                                <animate attributeName="width" values="60;10;30;5;20" dur="3s" repeatCount="indefinite"/>
                            </rect>
                        </g>

                        <!-- Transportation -->
                        <g id="transport-node" class="infrastructure-node cursor-pointer" data-node="transport">
                            <circle cx="550" cy="300" r="25" fill="#0369a1" stroke="#93c5fd" stroke-width="3" class="node-circle"/>
                            <text x="550" y="305" text-anchor="middle" fill="white" font-size="10" font-weight="bold">üöä</text>
                            <text x="550" y="330" text-anchor="middle" fill="#93c5fd" font-size="10">Transport</text>
                            <rect x="520" y="335" width="60" height="8" fill="#1e3a8a" rx="4"/>
                            <rect x="520" y="335" width="50" height="8" fill="#0369a1" rx="4" class="health-bar"/>
                        </g>

                        <!-- Financial Services -->
                        <g id="financial-node" class="infrastructure-node cursor-pointer" data-node="financial">
                            <circle cx="200" cy="280" r="25" fill="#16a34a" stroke="#86efac" stroke-width="3" class="node-circle"/>
                            <text x="200" y="285" text-anchor="middle" fill="white" font-size="10" font-weight="bold">üè¶</text>
                            <text x="200" y="310" text-anchor="middle" fill="#86efac" font-size="10">Banking</text>
                            <rect x="170" y="315" width="60" height="8" fill="#14532d" rx="4"/>
                            <rect x="170" y="315" width="55" height="8" fill="#16a34a" rx="4" class="health-bar"/>
                        </g>

                        <!-- Water Treatment -->
                        <g id="water-node" class="infrastructure-node cursor-pointer" data-node="water">
                            <circle cx="450" cy="320" r="25" fill="#0891b2" stroke="#67e8f9" stroke-width="3" class="node-circle"/>
                            <text x="450" y="325" text-anchor="middle" fill="white" font-size="10" font-weight="bold">üíß</text>
                            <text x="450" y="350" text-anchor="middle" fill="#67e8f9" font-size="10">Water</text>
                            <rect x="420" y="355" width="60" height="8" fill="#164e63" rx="4"/>
                            <rect x="420" y="355" width="58" height="8" fill="#0891b2" rx="4" class="health-bar"/>
                        </g>

                        <!-- Attack Traffic Visualization -->
                        <g id="attack-traffic">
                            <!-- Animated attack paths -->
                            <line x1="0" y1="0" x2="150" y2="100" stroke="#dc2626" stroke-width="3" opacity="0.7" class="attack-line">
                                <animate attributeName="opacity" values="0;1;0" dur="1s" repeatCount="indefinite"/>
                            </line>
                            <line x1="800" y1="0" x2="350" y2="120" stroke="#dc2626" stroke-width="3" opacity="0.7" class="attack-line">
                                <animate attributeName="opacity" values="0;1;0" dur="1.2s" repeatCount="indefinite"/>
                            </line>
                            <line x1="800" y1="400" x2="650" y2="140" stroke="#ea580c" stroke-width="3" opacity="0.7" class="attack-line">
                                <animate attributeName="opacity" values="0;1;0" dur="0.8s" repeatCount="indefinite"/>
                            </line>
                        </g>
                    </svg>

                    <!-- Live Attack Feed -->
                    <div class="absolute top-4 right-4 bg-red-900/80 border border-red-500 rounded p-3 max-w-xs">
                        <div class="text-red-300 text-xs font-bold mb-2">üö® LIVE ATTACK FEED</div>
                        <div id="attack-feed" class="text-red-200 text-xs space-y-1 max-h-24 overflow-y-auto">
                            <!-- Live attack notifications will appear here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Defense Control Panel -->
            <div class="col-span-4 space-y-4">
                <!-- Selected Node Info -->
                <div class="bg-gray-800/90 backdrop-blur border border-gray-600 rounded-lg p-4">
                    <h3 class="text-lg font-semibold text-cyan-300 mb-3 flex items-center gap-2">
                        <i class="bi bi-crosshair"></i> Defense Target
                    </h3>
                    
                    <div id="no-selection" class="text-center text-gray-400 py-8">
                        <i class="bi bi-target text-4xl mb-3"></i>
                        <p>Click on an infrastructure node to begin defense operations</p>
                    </div>

                    <div id="node-details" class="hidden">
                        <div class="flex items-center gap-3 mb-4">
                            <div id="node-icon" class="w-12 h-12 bg-red-500 rounded-lg flex items-center justify-center text-white text-xl"></div>
                            <div>
                                <h4 id="node-name" class="text-white font-bold text-lg"></h4>
                                <p id="node-status" class="text-red-400 text-sm"></p>
                            </div>
                        </div>

                        <!-- Real-time Attack Data -->
                        <div class="space-y-3 mb-4">
                            <div class="bg-black/30 rounded p-3">
                                <div class="text-red-300 text-sm font-semibold mb-2">Attack Analysis</div>
                                <div class="space-y-2 text-xs">
                                    <div class="flex justify-between">
                                        <span class="text-gray-300">Traffic Volume:</span>
                                        <span id="node-traffic" class="text-red-400 font-mono">0 Gbps</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-300">Attack Type:</span>
                                        <span id="attack-type" class="text-orange-400">Volumetric</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-300">Source IPs:</span>
                                        <span id="source-ips" class="text-yellow-400">0</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-300">Service Health:</span>
                                        <span id="service-health" class="text-red-400">Critical</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Mitigation Actions -->
                        <div class="space-y-2">
                            <div class="text-cyan-300 text-sm font-semibold mb-2">Available Mitigations</div>
                            
                            <button class="mitigation-action w-full bg-red-600 hover:bg-red-700 text-white p-3 rounded text-sm font-medium transition-all" 
                                    data-action="rate-limit" data-cost="5">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center gap-2">
                                        <i class="bi bi-speedometer2"></i>
                                        <span>Rate Limiting</span>
                                    </div>
                                    <span class="text-xs bg-red-800 px-2 py-1 rounded">5sec</span>
                                </div>
                                <div class="text-xs text-red-200 mt-1">Reduce incoming request rate by 70%</div>
                            </button>

                            <button class="mitigation-action w-full bg-blue-600 hover:bg-blue-700 text-white p-3 rounded text-sm font-medium transition-all" 
                                    data-action="geo-block" data-cost="8">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center gap-2">
                                        <i class="bi bi-globe"></i>
                                        <span>Geo-blocking</span>
                                    </div>
                                    <span class="text-xs bg-blue-800 px-2 py-1 rounded">8sec</span>
                                </div>
                                <div class="text-xs text-blue-200 mt-1">Block traffic from attack source countries</div>
                            </button>

                            <button class="mitigation-action w-full bg-green-600 hover:bg-green-700 text-white p-3 rounded text-sm font-medium transition-all" 
                                    data-action="captcha" data-cost="12">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center gap-2">
                                        <i class="bi bi-shield-check"></i>
                                        <span>CAPTCHA Challenge</span>
                                    </div>
                                    <span class="text-xs bg-green-800 px-2 py-1 rounded">12sec</span>
                                </div>
                                <div class="text-xs text-green-200 mt-1">Challenge suspicious traffic patterns</div>
                            </button>

                            <button class="mitigation-action w-full bg-purple-600 hover:bg-purple-700 text-white p-3 rounded text-sm font-medium transition-all" 
                                    data-action="cdn-redirect" data-cost="15">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center gap-2">
                                        <i class="bi bi-arrow-repeat"></i>
                                        <span>CDN Redirect</span>
                                    </div>
                                    <span class="text-xs bg-purple-800 px-2 py-1 rounded">15sec</span>
                                </div>
                                <div class="text-xs text-purple-200 mt-1">Route traffic through clean CDN nodes</div>
                            </button>

                            <button class="mitigation-action w-full bg-orange-600 hover:bg-orange-700 text-white p-3 rounded text-sm font-medium transition-all" 
                                    data-action="blackhole" data-cost="3">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center gap-2">
                                        <i class="bi bi-ban"></i>
                                        <span>Emergency Blackhole</span>
                                    </div>
                                    <span class="text-xs bg-orange-800 px-2 py-1 rounded">3sec</span>
                                </div>
                                <div class="text-xs text-orange-200 mt-1">Block all traffic (last resort)</div>
                            </button>
                        </div>

                        <!-- Active Mitigations -->
                        <div id="active-mitigations" class="mt-4">
                            <div class="text-green-300 text-sm font-semibold mb-2">Active Defenses</div>
                            <div id="active-list" class="space-y-1">
                                <!-- Active mitigations will be shown here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Global Defense Status -->
                <div class="bg-gray-800/90 backdrop-blur border border-gray-600 rounded-lg p-4">
                    <h3 class="text-lg font-semibold text-cyan-300 mb-3">City-wide Status</h3>
                    
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-300">Overall Network Health</span>
                            <div class="w-24 bg-gray-700 rounded-full h-2">
                                <div id="overall-health" class="bg-red-400 h-2 rounded-full transition-all" style="width: 30%"></div>
                            </div>
                        </div>
                        
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-300">Defense Readiness</span>
                            <div class="w-24 bg-gray-700 rounded-full h-2">
                                <div id="defense-readiness" class="bg-blue-400 h-2 rounded-full transition-all" style="width: 85%"></div>
                            </div>
                        </div>
                        
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-300">Response Time</span>
                            <span id="avg-response-time" class="text-yellow-400 text-sm font-mono">2.3s avg</span>
                        </div>
                    </div>
                </div>

                <!-- Mission Objective -->
                <div class="bg-blue-900/50 border border-blue-500 rounded-lg p-4">
                    <h3 class="text-blue-300 font-semibold mb-2">üéØ Mission Objective</h3>
                    <div class="text-blue-200 text-sm space-y-2">
                        <p>‚Ä¢ Maintain >70% uptime across all critical infrastructure</p>
                        <p>‚Ä¢ Deploy effective mitigations within 30 seconds of attack detection</p>
                        <p>‚Ä¢ Minimize service disruption to civilian population</p>
                        <p>‚Ä¢ Survive until The Null exhausts their attack resources</p>
                    </div>
                    <div class="mt-3 bg-blue-800/30 rounded p-2">
                        <div class="text-blue-300 text-xs font-semibold">Mission Progress</div>
                        <div class="flex justify-between text-xs">
                            <span>Nodes Defended: <span id="nodes-defended">0/6</span></span>
                            <span>Time Survived: <span id="time-survived">00:00</span></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Commander Messages -->
    <div class="fixed bottom-4 left-4 max-w-md bg-red-900/90 backdrop-blur border border-red-500 rounded-lg p-4 shadow-lg">
        <div class="flex items-start gap-3">
            <div class="bg-red-400 rounded-full w-10 h-10 flex items-center justify-center flex-shrink-0">
                <i class="bi bi-person-badge text-white"></i>
            </div>
            <div class="flex-1">
                <div class="flex items-center gap-2 mb-2">
                    <h4 class="font-semibold text-red-300">Commander Vega</h4>
                    <span class="text-xs bg-red-700 text-red-200 px-2 py-1 rounded">LIVE</span>
                </div>
                <p id="commander-message" class="text-red-200 text-sm">
                    Nova, multiple infrastructure nodes are reporting critical service degradation. 
                    Priority one: keep emergency services online. Every second counts!
                </p>
            </div>
        </div>
    </div>

    <!-- Results Modal -->
    <div id="results-modal" class="fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 hidden">
        <div class="bg-gray-800 rounded-lg p-8 max-w-lg mx-4 border border-gray-600">
            <div class="text-center">
                <div id="result-icon" class="text-6xl mb-4"></div>
                <h3 id="result-title" class="text-2xl font-bold mb-4"></h3>
                <p id="result-message" class="text-gray-200 mb-6"></p>
                <div id="result-feedback" class="bg-gray-700 rounded p-4 mb-6 text-left"></div>
                <button id="continue-btn" class="bg-cyan-500 hover:bg-cyan-600 text-white px-6 py-3 rounded font-medium">
                    Continue
                </button>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <div class="fixed bottom-4 right-4">
        <button id="complete-level" class="bg-cyan-500 hover:bg-cyan-600 text-white px-6 py-3 rounded font-medium disabled:bg-gray-600 disabled:cursor-not-allowed" disabled>
            Complete Defense Mission <i class="bi bi-arrow-right ml-2"></i>
        </button>
    </div>
</div>

<!-- Level 9 JavaScript -->
<script type="module" src="{{ url_for('static', filename='js/levels/level-9/level-9.js') }}"></script>
{% endblock %}